<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      html { height: 100% }
      body { height: 100%; margin: 0; padding: 0 }
      #map_canvas { height: 100% }
    </style>

    <script type="text/javascript" src="http://maps.google.com/maps/api/js?sensor=true"></script>
    <script type="text/javascript" src="locations.json"></script>
    <script type="text/javascript">
      var map = null;
      var latlng = new google.maps.LatLng(37.762573,-122.432327);
      var infoWindow = new google.maps.InfoWindow();
      //var markerArray = [];

      function makeMarker(options) {
        var pushPin = new google.maps.Marker({map:map});
        pushPin.setOptions(options);
        google.maps.event.addListener(pushPin, 'click', function() {
          infoWindow.setOptions(options);
          infoWindow.open(map, pushPin);
        });
        //markerArray.push(pushPin);
        return pushPin;
      }

      function initialize() {
        map = new google.maps.Map(document.getElementById("map_canvas"), {
          streetViewControl: false,
          panControl: false,
          disableDoubleClickZoom: false,
          mapTypeControl: false,
          zoom: 13,
          center: latlng,
          mapTypeId: google.maps.MapTypeId.ROADMAP,
          zoomControlOptions: { style: google.maps.ZoomControlStyle.LARGE }
        });

        for(var i in locations) {
          loc = locations[i].location;
          makeMarker({
            icon: new google.maps.MarkerImage('http://maps.google.com/mapfiles/ms/icons/red-dot.png'),
            position: new google.maps.LatLng(loc.latitude, loc.longitude),
            title: loc.name,
            content: loc.address,
          });
        }

        google.maps.event.addListener(map, 'click', function() {
          infoWindow.close();
        });
      }

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
  </head>
  <body>
    <div id="map_canvas"></div>
  </body>
</html>
